

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Chem module &mdash; ChemML 0.5.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Magpie_Python module" href="chemml.chem.magpie_python.html" />
    <link rel="prev" title="Feature Selection" href="ga_feature_selection.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> ChemML
          

          
          </a>

          
            
            
              <div class="version">
                0.5.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">ChemML Wrapper documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="CMLWTutorial.html">ChemML Wrapper Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="CMLWInputFile.html">Input File Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="CMLWInputFileGenerator.html">Input File GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="CMLWContentsTable.html">Table of Contents</a></li>
<li class="toctree-l1"><a class="reference internal" href="CMLWReference.html">Wrapper Reference</a></li>
</ul>
<p class="caption"><span class="caption-text">ChemML library Tutorial</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="molecule.html">Molecule</a></li>
<li class="toctree-l1"><a class="reference internal" href="active_model_based.html">Active Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="ga_hyper_opt.html">Hyperparameter Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="ga_feature_selection.html">Feature Selection</a></li>
</ul>
<p class="caption"><span class="caption-text">ChemML library documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Chem module</a></li>
<li class="toctree-l1"><a class="reference internal" href="chemml.chem.magpie_python.html">Magpie_Python module</a></li>
<li class="toctree-l1"><a class="reference internal" href="chemml.initialization.html">Initialization module</a></li>
<li class="toctree-l1"><a class="reference internal" href="chemml.datasets.html">Datasets module</a></li>
<li class="toctree-l1"><a class="reference internal" href="chemml.preprocessing.html">chemml.preprocessing module</a></li>
<li class="toctree-l1"><a class="reference internal" href="chemml.models.html">Models module</a></li>
<li class="toctree-l1"><a class="reference internal" href="chemml.optimization.html">Optimization module</a></li>
<li class="toctree-l1"><a class="reference internal" href="chemml.visualization.html">chemml.visualization module</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ChemML</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Chem module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/chemml.chem.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="chem-module">
<h1>Chem module<a class="headerlink" href="#chem-module" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-chemml.chem"></span><dl class="docutils">
<dt>The chemml.chem module includes (please click on links adjacent to function names for more information):</dt>
<dd><ul class="first last simple">
<li>Molecule: <a class="reference internal" href="#chemml.chem.Molecule" title="chemml.chem.Molecule"><code class="xref py py-func docutils literal notranslate"><span class="pre">Molecule()</span></code></a></li>
<li>XYZ: <a class="reference internal" href="#chemml.chem.XYZ" title="chemml.chem.XYZ"><code class="xref py py-func docutils literal notranslate"><span class="pre">XYZ()</span></code></a></li>
<li>CoulombMatrix: <a class="reference internal" href="#chemml.chem.CoulombMatrix" title="chemml.chem.CoulombMatrix"><code class="xref py py-func docutils literal notranslate"><span class="pre">CoulombMatrix()</span></code></a></li>
<li>BagofBonds: <a class="reference internal" href="#chemml.chem.BagofBonds" title="chemml.chem.BagofBonds"><code class="xref py py-func docutils literal notranslate"><span class="pre">BagofBonds()</span></code></a></li>
<li>RDKitFingerprint: <a class="reference internal" href="#chemml.chem.RDKitFingerprint" title="chemml.chem.RDKitFingerprint"><code class="xref py py-func docutils literal notranslate"><span class="pre">RDKitFingerprint()</span></code></a></li>
<li>Dragon: <a class="reference internal" href="#chemml.chem.Dragon" title="chemml.chem.Dragon"><code class="xref py py-func docutils literal notranslate"><span class="pre">Dragon()</span></code></a></li>
</ul>
</dd>
</dl>
<dl class="class">
<dt id="chemml.chem.Molecule">
<em class="property">class </em><code class="descclassname">chemml.chem.</code><code class="descname">Molecule</code><span class="sig-paren">(</span><em>input</em>, <em>input_type</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#chemml.chem.Molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>The central class to construct a molecule from different chemical input formats.
This module is built on top of RDKit and OpenBabel python API.
We join the forces and strength of these two cheminformatic libraris for a consistent user experience.</p>
<p>Almost all the molecular descriptors and molecule-based ML models require the chemical informatin as a Molecule object.
Several methods are available in this module to facilitate the manipulation of chemical data.</p>
<dl class="docutils">
<dt>input: str</dt>
<dd>The representation string or path to a file.</dd>
<dt>input_type: str</dt>
<dd><p class="first">The input type.
The available types are enlisted here:</p>
<blockquote class="last">
<div><ul class="simple">
<li>smiles: The input must be SMILES representation of a molecule.</li>
<li>smarts: The input must be SMARTS representation of a molecule.</li>
<li>inchi: The input must be InChi representation of a molecule.</li>
<li>xyz:  The input must be the path to an xyz file.</li>
</ul>
</div></blockquote>
</dd>
<dt>kwargs:</dt>
<dd><dl class="first last docutils">
<dt>The corresponding RDKit arguments for each of the input types:</dt>
<dd><ul class="first last simple">
<li>smiles: <a class="reference external" href="http://rdkit.org/docs/source/rdkit.Chem.rdmolfiles.html#rdkit.Chem.rdmolfiles.MolFromSmiles">http://rdkit.org/docs/source/rdkit.Chem.rdmolfiles.html#rdkit.Chem.rdmolfiles.MolFromSmiles</a></li>
<li>smarts: <a class="reference external" href="http://rdkit.org/docs/source/rdkit.Chem.rdmolfiles.html#rdkit.Chem.rdmolfiles.MolFromSmarts">http://rdkit.org/docs/source/rdkit.Chem.rdmolfiles.html#rdkit.Chem.rdmolfiles.MolFromSmarts</a></li>
<li>inchi: <a class="reference external" href="http://rdkit.org/docs/source/rdkit.Chem.inchi.html?highlight=inchi#rdkit.Chem.inchi.MolFromInchi">http://rdkit.org/docs/source/rdkit.Chem.inchi.html?highlight=inchi#rdkit.Chem.inchi.MolFromInchi</a></li>
</ul>
</dd>
</dl>
</dd>
</dl>
<blockquote>
<div><ul class="simple">
<li>The molecule will be creatd as an RDKit molecule object.</li>
<li>The molecule object will be stored and available as <cite>rdkit_molecule</cite> attribute.</li>
<li><dl class="first docutils">
<dt>If you load a molecule from its SMARTS string, there is high probability that you can’t convert it to other</dt>
<dd>types due to the abstract description of the molecules by SMARTS representation.</dd>
</dl>
</li>
</ul>
</div></blockquote>
<dl class="docutils">
<dt>rdkit_molecule: object</dt>
<dd>The <cite>rdkit.Chem.rdchem.Mol</cite> object</dd>
<dt>smiles: str</dt>
<dd>The SMILES string that you get by running the <cite>to_smiles</cite> method.</dd>
<dt>smarts: str</dt>
<dd>The SMARTS string that you get by running the <cite>to_smarts</cite> method.</dd>
<dt>inchi: str</dt>
<dd>The InChi string that you get by running the <cite>to_inchi</cite> method.</dd>
<dt>xyz: instance of &lt;class ‘chemml.chem.molecule.XYZ’&gt;</dt>
<dd>The class object that stores the 3D info. The available attributes in the class are ‘geometry’,
‘atomic_numbers’, and ‘atomic_symbols’.</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chemml.chem</span> <span class="k">import</span> <span class="n">Molecule</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">caffeine_smiles</span> <span class="o">=</span> <span class="s1">&#39;CN1C=NC2=C1C(=O)N(C(=O)N2C)C&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">caffeine_smarts</span> <span class="o">=</span> <span class="s1">&#39;[#6]-[#7]1:[#6]:[#7]:[#6]2:[#6]:1:[#6](=[#8]):[#7](:[#6](=[#8]):[#7]:2-[#6])-[#6]&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">caffeine_inchi</span> <span class="o">=</span> <span class="s1">&#39;InChI=1S/C8H10N4O2/c1-10-4-9-6-5(10)7(13)12(3)8(14)11(6)2/h4H,1-3H3&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">caffeine_smiles</span><span class="p">,</span> <span class="s1">&#39;smiles&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span>
<span class="go">&lt;Molecule(rdkit_molecule : &lt;rdkit.Chem.rdchem.Mol object at 0x11060a8a0&gt;,</span>
<span class="go">      creator        : (&#39;SMILES&#39;, &#39;CN1C=NC2=C1C(=O)N(C(=O)N2C)C&#39;),</span>
<span class="go">      smiles         : &#39;Cn1c(=O)c2c(ncn2C)n(C)c1=O&#39;,</span>
<span class="go">      smarts         : None,</span>
<span class="go">      inchi          : None,</span>
<span class="go">      xyz            : None)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">smiles</span> <span class="c1"># this is the canonical SMILES by default</span>
<span class="go">&#39;Cn1c(=O)c2c(ncn2C)n(C)c1=O&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">creator</span>
<span class="go">(&#39;SMILES&#39;, &#39;CN1C=NC2=C1C(=O)N(C(=O)N2C)C&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">to_smiles</span><span class="p">(</span><span class="n">kekuleSmiles</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span>
<span class="go">&lt;Molecule(rdkit_molecule : &lt;rdkit.Chem.rdchem.Mol object at 0x11060a8a0&gt;,</span>
<span class="go">      creator        : (&#39;SMILES&#39;, &#39;CN1C=NC2=C1C(=O)N(C(=O)N2C)C&#39;),</span>
<span class="go">      smiles         : &#39;CN1C(=O)C2=C(N=CN2C)N(C)C1=O&#39;,</span>
<span class="go">      smarts         : None,</span>
<span class="go">      inchi          : None,</span>
<span class="go">      xyz            : None)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">smiles</span> <span class="c1"># the kukule SMILES is not canonical</span>
<span class="go">&#39;CN1C(=O)C2=C(N=CN2C)N(C)C1=O&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">inchi</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">to_inchi</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span>
<span class="go">&lt;Molecule(rdkit_molecule : &lt;rdkit.Chem.rdchem.Mol object at 0x11060a8a0&gt;,</span>
<span class="go">      creator        : (&#39;SMILES&#39;, &#39;CN1C=NC2=C1C(=O)N(C(=O)N2C)C&#39;),</span>
<span class="go">      smiles         : &#39;CN1C(=O)C2=C(N=CN2C)N(C)C1=O&#39;,</span>
<span class="go">      smarts         : None,</span>
<span class="go">      inchi          : &#39;InChI=1S/C8H10N4O2/c1-10-4-9-6-5(10)7(13)12(3)8(14)11(6)2/h4H,1-3H3&#39;,</span>
<span class="go">      xyz            : None)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">inchi</span>
<span class="go">&#39;InChI=1S/C8H10N4O2/c1-10-4-9-6-5(10)7(13)12(3)8(14)11(6)2/h4H,1-3H3&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">to_smarts</span><span class="p">(</span><span class="n">isomericSmiles</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">smarts</span>
<span class="go">&#39;[#6]-[#7]1:[#6]:[#7]:[#6]2:[#6]:1:[#6](=[#8]):[#7](:[#6](=[#8]):[#7]:2-[#6])-[#6]&#39;</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># add hydrogens and recreate smiles and inchi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">hydrogens</span><span class="p">(</span><span class="s1">&#39;add&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">to_smiles</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">to_inchi</span><span class="p">()</span>
<span class="go">&lt;Molecule(rdkit_molecule : &lt;rdkit.Chem.rdchem.Mol object at 0x11060ab70&gt;,</span>
<span class="go">      creator        : (&#39;SMILES&#39;, &#39;CN1C=NC2=C1C(=O)N(C(=O)N2C)C&#39;),</span>
<span class="go">      smiles         : &#39;[H]c1nc2c(c(=O)n(C([H])([H])[H])c(=O)n2C([H])([H])[H])n1C([H])([H])[H]&#39;,</span>
<span class="go">      smarts         : &#39;[#6]-[#7]1:[#6]:[#7]:[#6]2:[#6]:1:[#6](=[#8]):[#7](:[#6](=[#8]):[#7]:2-[#6])-[#6]&#39;,</span>
<span class="go">      inchi          : &#39;InChI=1S/C8H10N4O2/c1-10-4-9-6-5(10)7(13)12(3)8(14)11(6)2/h4H,1-3H3&#39;,</span>
<span class="go">      xyz            : None)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># note that by addition of hydrogens, the smiles string changed, but not inchi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">to_xyz</span><span class="p">()</span>
<span class="go">ValueError: The conformation has not been built yet. Maybe due to the 2D representation of the creator.</span>
<span class="go">You should set the optimizer value if you wish to embed and optimize the 3D geometries.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">to_xyz</span><span class="p">(</span><span class="s1">&#39;MMFF&#39;</span><span class="p">,</span> <span class="n">maxIters</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">mmffVariant</span><span class="o">=</span><span class="s1">&#39;MMFF94s&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span>
<span class="go">&lt;Molecule(rdkit_molecule : &lt;rdkit.Chem.rdchem.Mol object at 0x11060ab70&gt;,</span>
<span class="go">      creator        : (&#39;SMILES&#39;, &#39;CN1C=NC2=C1C(=O)N(C(=O)N2C)C&#39;),</span>
<span class="go">      smiles         : &#39;[H]c1nc2c(c(=O)n(C([H])([H])[H])c(=O)n2C([H])([H])[H])n1C([H])([H])[H]&#39;,</span>
<span class="go">      smarts         : &#39;[#6]-[#7]1:[#6]:[#7]:[#6]2:[#6]:1:[#6](=[#8]):[#7](:[#6](=[#8]):[#7]:2-[#6])-[#6]&#39;,</span>
<span class="go">      inchi          : &#39;InChI=1S/C8H10N4O2/c1-10-4-9-6-5(10)7(13)12(3)8(14)11(6)2/h4H,1-3H3&#39;,</span>
<span class="go">      xyz            : &lt;chemml.chem.molecule.XYZ object at 0x1105f34e0&gt;)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">xyz</span>
<span class="go">&lt;chemml.chem.molecule.XYZ object at 0x1105f34e0&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">xyz</span><span class="o">.</span><span class="n">geometry</span>
<span class="go">array([[-3.13498321,  1.08078307,  0.33372515],</span>
<span class="go">   [-2.15703638,  0.0494926 ,  0.0969075 ],</span>
<span class="go">   [-2.41850776, -1.27323453, -0.14538583],</span>
<span class="go">   [-1.30933543, -1.96359887, -0.32234393],</span>
<span class="go">   [-0.31298208, -1.04463051, -0.1870366 ],</span>
<span class="go">   [-0.80033326,  0.20055608,  0.07079013],</span>
<span class="go">   [ 0.02979071,  1.33923464,  0.25484381],</span>
<span class="go">   [-0.41969338,  2.45755985,  0.48688003],</span>
<span class="go">   [ 1.39083332,  1.04039479,  0.14253256],</span>
<span class="go">   [ 1.93405927, -0.23430839, -0.12320318],</span>
<span class="go">   [ 3.15509616, -0.39892779, -0.20417755],</span>
<span class="go">   [ 1.03516373, -1.28860035, -0.28833489],</span>
<span class="go">   [ 1.51247526, -2.63123373, -0.56438513],</span>
<span class="go">   [ 2.34337825,  2.12037198,  0.31039958],</span>
<span class="go">   [-3.03038469,  1.84426033, -0.44113804],</span>
<span class="go">   [-2.95880047,  1.50667225,  1.32459816],</span>
<span class="go">   [-4.13807215,  0.64857048,  0.29175711],</span>
<span class="go">   [-3.4224011 , -1.6776074 , -0.18199971],</span>
<span class="go">   [ 2.60349515, -2.67375289, -0.61674561],</span>
<span class="go">   [ 1.10339164, -2.96582894, -1.52299068],</span>
<span class="go">   [ 1.17455601, -3.30144289,  0.23239402],</span>
<span class="go">   [ 2.94406381,  2.20916763, -0.60086251],</span>
<span class="go">   [ 1.86156872,  3.07985237,  0.51337935],</span>
<span class="go">   [ 3.01465788,  1.87625024,  1.14039627]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">xyz</span><span class="o">.</span><span class="n">atomic_numbers</span>
<span class="go">array([[6],</span>
<span class="go">   [7],</span>
<span class="go">   [6],</span>
<span class="go">   [7],</span>
<span class="go">   [6],</span>
<span class="go">   [6],</span>
<span class="go">   [6],</span>
<span class="go">   [8],</span>
<span class="go">   [7],</span>
<span class="go">   [6],</span>
<span class="go">   [8],</span>
<span class="go">   [7],</span>
<span class="go">   [6],</span>
<span class="go">   [6],</span>
<span class="go">   [1],</span>
<span class="go">   [1],</span>
<span class="go">   [1],</span>
<span class="go">   [1],</span>
<span class="go">   [1],</span>
<span class="go">   [1],</span>
<span class="go">   [1],</span>
<span class="go">   [1],</span>
<span class="go">   [1],</span>
<span class="go">   [1]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">xyz</span><span class="o">.</span><span class="n">atomic_symbols</span>
<span class="go">array([[&#39;C&#39;],</span>
<span class="go">       [&#39;N&#39;],</span>
<span class="go">       [&#39;C&#39;],</span>
<span class="go">       [&#39;N&#39;],</span>
<span class="go">       [&#39;C&#39;],</span>
<span class="go">       [&#39;C&#39;],</span>
<span class="go">       [&#39;C&#39;],</span>
<span class="go">       [&#39;O&#39;],</span>
<span class="go">       [&#39;N&#39;],</span>
<span class="go">       [&#39;C&#39;],</span>
<span class="go">       [&#39;O&#39;],</span>
<span class="go">       [&#39;N&#39;],</span>
<span class="go">       [&#39;C&#39;],</span>
<span class="go">       [&#39;C&#39;],</span>
<span class="go">       [&#39;H&#39;],</span>
<span class="go">       [&#39;H&#39;],</span>
<span class="go">       [&#39;H&#39;],</span>
<span class="go">       [&#39;H&#39;],</span>
<span class="go">       [&#39;H&#39;],</span>
<span class="go">       [&#39;H&#39;],</span>
<span class="go">       [&#39;H&#39;],</span>
<span class="go">       [&#39;H&#39;],</span>
<span class="go">       [&#39;H&#39;],</span>
<span class="go">       [&#39;H&#39;]], dtype=&#39;&lt;U1&#39;)</span>
</pre></div>
</div>
<dl class="method">
<dt id="chemml.chem.Molecule.hydrogens">
<code class="descname">hydrogens</code><span class="sig-paren">(</span><em>action='add'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#chemml.chem.Molecule.hydrogens" title="Permalink to this definition">¶</a></dt>
<dd><p>This function adds/removes hydrogens to/from a prebuilt molecule object.</p>
<dl class="docutils">
<dt>action: str</dt>
<dd>Either ‘add’ or ‘remove’, to add hydrogns or remove them from the rdkit molecule.</dd>
<dt>kwargs:</dt>
<dd>The arguments that can be passed to the rdkit functions:
- <cite>Chem.AddHs</cite>: documentation at <a class="reference external" href="http://rdkit.org/docs/source/rdkit.Chem.rdmolops.html?highlight=addhs#rdkit.Chem.rdmolops.AddHs">http://rdkit.org/docs/source/rdkit.Chem.rdmolops.html?highlight=addhs#rdkit.Chem.rdmolops.AddHs</a>
- <cite>Chem.RemoveHs</cite>: documentation at <a class="reference external" href="http://rdkit.org/docs/source/rdkit.Chem.rdmolops.html?highlight=addhs#rdkit.Chem.rdmolops.RemoveHs">http://rdkit.org/docs/source/rdkit.Chem.rdmolops.html?highlight=addhs#rdkit.Chem.rdmolops.RemoveHs</a></dd>
</dl>
<blockquote>
<div><ul class="simple">
<li>The rdkit or pybel molecule object must be created in advance.</li>
<li>Only rdkit or pybel molecule object will be modified in place.</li>
<li>If you remove hydrogens from molecules, the atomic 3D coordinates might not be accurate for the conversion to xyz representation.</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="chemml.chem.Molecule.to_inchi">
<code class="descname">to_inchi</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#chemml.chem.Molecule.to_inchi" title="Permalink to this definition">¶</a></dt>
<dd><p>This function creates and stores the InChi string for a pre-built molecule.</p>
<dl class="docutils">
<dt>kwargs:</dt>
<dd>The arguments that can be passed to the rdkit.Chem.MolToInchi function (will be used only if rdkit molecule is available).
The documentation is available at: <a class="reference external" href="http://rdkit.org/docs/source/rdkit.Chem.inchi.html?highlight=inchi#rdkit.Chem.inchi.MolToInchi">http://rdkit.org/docs/source/rdkit.Chem.inchi.html?highlight=inchi#rdkit.Chem.inchi.MolToInchi</a></dd>
</dl>
<blockquote>
<div><ul class="simple">
<li>The rdkit or pybel molecule object must be created in advance.</li>
<li>The molecule will be modified in place.</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="chemml.chem.Molecule.to_smarts">
<code class="descname">to_smarts</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#chemml.chem.Molecule.to_smarts" title="Permalink to this definition">¶</a></dt>
<dd><p>This function creates and stores the SMARTS string for a pre-built molecule.</p>
<dl class="docutils">
<dt>kwargs:</dt>
<dd>All the arguments that can be passed to the rdkit.Chem.MolToSmarts function.
The documentation is available at: <a class="reference external" href="http://rdkit.org/docs/source/rdkit.Chem.rdmolfiles.html#rdkit.Chem.rdmolfiles.MolToSmarts">http://rdkit.org/docs/source/rdkit.Chem.rdmolfiles.html#rdkit.Chem.rdmolfiles.MolToSmarts</a></dd>
</dl>
<blockquote>
<div><ul class="simple">
<li>The rdkit or pybel molecule object must be created in advance.</li>
<li>If only pybel molecule is available, we create an rdkit molecule using its SMILES representation, and then create the SMARTS string using rdkit arguments.</li>
<li>The molecule will be modified in place.</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="chemml.chem.Molecule.to_smiles">
<code class="descname">to_smiles</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#chemml.chem.Molecule.to_smiles" title="Permalink to this definition">¶</a></dt>
<dd><p>This function creates and stores the SMILES string for a pre-built molecule.</p>
<dl class="docutils">
<dt>kwargs:</dt>
<dd>The arguments for the rdkit.Chem.MolToSmiles function.
The documentation is available at: <a class="reference external" href="http://rdkit.org/docs/source/rdkit.Chem.rdmolfiles.html#rdkit.Chem.rdmolfiles.MolToSmiles">http://rdkit.org/docs/source/rdkit.Chem.rdmolfiles.html#rdkit.Chem.rdmolfiles.MolToSmiles</a></dd>
</dl>
<blockquote>
<div><ul class="simple">
<li>The rdkit or pybel molecule object must be created in advance.</li>
<li>If only pybel molecule is available, we create an rdkit molecule using its SMILES representation, and then recreate the SMILES string using rdkit arguments.</li>
<li>The molecule will be modified in place.</li>
<li>For rdkit molecule the SMILES string is canocical by default, unless when one requests kekuleSmiles.</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="chemml.chem.Molecule.to_xyz">
<code class="descname">to_xyz</code><span class="sig-paren">(</span><em>optimizer=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#chemml.chem.Molecule.to_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>This function creates and stores the xyz coordinates for a pre-built molecule object.</p>
<dl class="docutils">
<dt>optimizer: None or str, optional (default: None)</dt>
<dd>If None, the geometries will be extracted from the available source of 3D structure (if any).
Otherwise, any of the ‘UFF’ or ‘MMFF’ force fileds should be passed to embed and optimize geometries using ‘rdkit.Chem.AllChem.UFFOptimizeMolecule’ or
‘rdkit.Chem.AllChem.MMFFOptimizeMolecule’ methods, respectively.</dd>
<dt>kwargs:</dt>
<dd><p class="first">The arguments that can be passed to the corresponding forcefileds.
The documentation is available at:</p>
<blockquote class="last">
<div><ul class="simple">
<li>UFFOptimizeMolecule: <a class="reference external" href="http://rdkit.org/docs/source/rdkit.Chem.rdForceFieldHelpers.html?highlight=mmff#rdkit.Chem.rdForceFieldHelpers.UFFOptimizeMolecule">http://rdkit.org/docs/source/rdkit.Chem.rdForceFieldHelpers.html?highlight=mmff#rdkit.Chem.rdForceFieldHelpers.UFFOptimizeMolecule</a></li>
<li>MMFFOptimizeMolecule: <a class="reference external" href="http://rdkit.org/docs/source/rdkit.Chem.rdForceFieldHelpers.html?highlight=mmff#rdkit.Chem.rdForceFieldHelpers.MMFFOptimizeMolecule">http://rdkit.org/docs/source/rdkit.Chem.rdForceFieldHelpers.html?highlight=mmff#rdkit.Chem.rdForceFieldHelpers.MMFFOptimizeMolecule</a></li>
</ul>
</div></blockquote>
</dd>
</dl>
<blockquote>
<div><ul class="simple">
<li>The geometry will be stored in the <cite>xyz</cite> attribute.</li>
<li>The molecule object must be created in advance.</li>
<li>The hydrogens won’t be added to the molecule automatically. You should add it manually using <cite>hydrogens</cite> method.</li>
<li>If the molecule object has been built using 2D representations (e.g., SMILES or InChi), the conformer</li>
</ul>
<p>doesn’t exist and you nedd to set the optimizer parameter to any of the force fields.
- If the 3D info exist but you still need to run optimization, the 3D structure will be embedded from scratch (i.e., the current atom coordinates will be removed.)</p>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="chemml.chem.Molecule.visualize">
<code class="descname">visualize</code><span class="sig-paren">(</span><em>filename=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#chemml.chem.Molecule.visualize" title="Permalink to this definition">¶</a></dt>
<dd><p>This function visualizes the molecule. If both rdkit and pybel objects are avaialble, the rdkit object
will be used for visualization.</p>
<dl class="docutils">
<dt>filename: str, optional (default = None)</dt>
<dd>This is the path to the file that you want write the image in it.
Tkinter and Python Imaging Library are required for writing the image.</dd>
<dt>kwargs:</dt>
<dd><p class="first">any extra parameter that you want to pass to the rdkit or pybel draw tool.
Additional information at:</p>
<blockquote class="last">
<div><ul class="simple">
<li><a class="reference external" href="https://www.rdkit.org/docs/source/rdkit.Chem.Draw.html">https://www.rdkit.org/docs/source/rdkit.Chem.Draw.html</a></li>
<li><a class="reference external" href="http://openbabel.org/docs/dev/UseTheLibrary/Python_PybelAPI.html#pybel.Molecule.draw">http://openbabel.org/docs/dev/UseTheLibrary/Python_PybelAPI.html#pybel.Molecule.draw</a></li>
</ul>
</div></blockquote>
</dd>
</dl>
<dl class="docutils">
<dt>object</dt>
<dd>You will be able to display this object, e.g., inside the Jupyter Notebook.</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="chemml.chem.XYZ">
<em class="property">class </em><code class="descclassname">chemml.chem.</code><code class="descname">XYZ</code><span class="sig-paren">(</span><em>geometry</em>, <em>atomic_numbers</em>, <em>atomic_symbols</em><span class="sig-paren">)</span><a class="headerlink" href="#chemml.chem.XYZ" title="Permalink to this definition">¶</a></dt>
<dd><p>This class stores the information that is typically carried by standard XYZ files.</p>
<dl class="docutils">
<dt>geometry: ndarray</dt>
<dd>The numpy array of shape (number_of_atoms, 3).
It stores the xyz coordinates for each atom of the molecule.</dd>
<dt>atomic_numbers: ndarray</dt>
<dd>The numpy array of shape (number_of_atoms, 1).
It stores the atomic numbers of each atom in the molecule (in the same order as geometry).</dd>
<dt>atomic_symbols: ndarray</dt>
<dd>The numpy array of shape (number_of_atoms, 1).
It stores the atomic symbols of each atom in the molecule (in the same order as geometry).</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="chemml.chem.CoulombMatrix">
<em class="property">class </em><code class="descclassname">chemml.chem.</code><code class="descname">CoulombMatrix</code><span class="sig-paren">(</span><em>CMtype='SC'</em>, <em>max_n_atoms='auto'</em>, <em>nPerm=3</em>, <em>const=1</em><span class="sig-paren">)</span><a class="headerlink" href="#chemml.chem.CoulombMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>The implementation of coulomb matrix descriptors by Matthias Rupp et. al. 2012, PRL (All 3 different variations).</p>
<dl class="docutils">
<dt>CMtype: str, optional (default=’SC’)</dt>
<dd><dl class="first last docutils">
<dt>The coulomb matrix type, one of the following types:</dt>
<dd><ul class="first last simple">
<li>‘Unsorted_Matrix’ or ‘UM’</li>
<li>‘Unsorted_Triangular’ or ‘UT’</li>
<li>‘Eigenspectrum’ or ‘E’</li>
<li>‘Sorted_Coulomb’ or ‘SC’</li>
<li>‘Random_Coulomb’ or ‘RC’</li>
</ul>
</dd>
</dl>
</dd>
<dt>max_n_atoms: int or ‘auto’, optional (default = ‘auto’)</dt>
<dd>Set the maximum number of atoms per molecule (to which all representations will be padded).
If ‘auto’, we find it based on all input molecules.</dd>
<dt>nPerm: int, optional (default = 3)</dt>
<dd>Number of permutation of coulomb matrix per molecule for Random_Coulomb (RC) 
type of representation.</dd>
<dt>const: float, optional (default = 1)</dt>
<dd>The constant value for coordinates unit conversion to atomic unit
example: atomic unit -&gt; const=1, Angstrom -&gt; const=0.529
const/<a href="#id11"><span class="problematic" id="id12">|Ri-Rj|</span></a>, which denominator is the euclidean distance
between atoms i and j</dd>
</dl>
<dl class="method">
<dt id="chemml.chem.CoulombMatrix.represent">
<code class="descname">represent</code><span class="sig-paren">(</span><em>molecules</em><span class="sig-paren">)</span><a class="headerlink" href="#chemml.chem.CoulombMatrix.represent" title="Permalink to this definition">¶</a></dt>
<dd><p>provides coulomb matrix representation for input molecules.</p>
<dl class="docutils">
<dt>molecules: chemml.chem.Molecule object or list</dt>
<dd>If list, it must be a list of chemml.chem.Molecule objects, otherwise we raise a ValueError.
In addition, all the molecule objects must provide the XYZ information. Please make sure the XYZ geometry has been
stored or optimized in advance.</dd>
</dl>
<dl class="docutils">
<dt>Pandas DataFrame</dt>
<dd><p class="first">A data frame with same number of rows as number of molecules will be returned.
The exact shape of the dataframe depends on the type of CM as follows:</p>
<blockquote class="last">
<div><ul class="simple">
<li>shape of Unsorted_Matrix (UM): (n_molecules, max_n_atoms**2)</li>
<li>shape of Unsorted_Triangular (UT): (n_molecules, max_n_atoms*(max_n_atoms+1)/2)</li>
<li>shape of eigenspectrums (E): (n_molecules, max_n_atoms)</li>
<li>shape of Sorted_Coulomb (SC): (n_molecules, max_n_atoms*(max_n_atoms+1)/2)</li>
<li>shape of Random_Coulomb (RC): (n_molecules, nPerm * max_n_atoms * (max_n_atoms+1)/2)</li>
</ul>
</div></blockquote>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="chemml.chem.BagofBonds">
<em class="property">class </em><code class="descclassname">chemml.chem.</code><code class="descname">BagofBonds</code><span class="sig-paren">(</span><em>const=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#chemml.chem.BagofBonds" title="Permalink to this definition">¶</a></dt>
<dd><p>The implementation of bag of bonds version of coulomb matrix by katja Hansen et. al. 2015, JPCL.</p>
<dl class="docutils">
<dt>const: float, optional (default = 1.0)</dt>
<dd><p class="first">The constant value for coordinates unit conversion to atomic unit
if const=1.0, returns atomic unit
if const=0.529, returns Angstrom</p>
<p class="last">const/<a href="#id13"><span class="problematic" id="id14">|Ri-Rj|</span></a>, which denominator is the euclidean distance
between two atoms</p>
</dd>
</dl>
<dl class="docutils">
<dt><a href="#id15"><span class="problematic" id="id16">header_</span></a>: list of header for the bag of bonds data frame</dt>
<dd>contains one nuclear charge (represents single atom) or a tuple of two nuclear charges (represents a bond)</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chemml.datasets</span> <span class="k">import</span> <span class="n">load_xyz_polarizability</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chemml.chem</span> <span class="k">import</span> <span class="n">BagofBonds</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">coordinates</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">load_xyz_polarizability</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bob</span> <span class="o">=</span> <span class="n">BagofBonds</span><span class="p">(</span><span class="n">const</span><span class="o">=</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">bob</span><span class="o">.</span><span class="n">represent</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="chemml.chem.BagofBonds.represent">
<code class="descname">represent</code><span class="sig-paren">(</span><em>molecules</em><span class="sig-paren">)</span><a class="headerlink" href="#chemml.chem.BagofBonds.represent" title="Permalink to this definition">¶</a></dt>
<dd><p>provides bag of bonds representation for input molecules.</p>
<dl class="docutils">
<dt>molecules: chemml.chem.Molecule object or list</dt>
<dd>If list, it must be a list of chemml.chem.Molecule objects, otherwise we raise a ValueError.
In addition, all the molecule objects must provide the XYZ information. Please make sure the XYZ geometry has been
stored or optimized in advance.</dd>
</dl>
<p>pandas data frame, shape: (n_molecules, max_length_of_combinations)</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="chemml.chem.RDKitFingerprint">
<em class="property">class </em><code class="descclassname">chemml.chem.</code><code class="descname">RDKitFingerprint</code><span class="sig-paren">(</span><em>remove_hydrogen=True</em>, <em>fingerprint_type='Morgan'</em>, <em>vector='bit'</em>, <em>n_bits=1024</em>, <em>radius=2</em><span class="sig-paren">)</span><a class="headerlink" href="#chemml.chem.RDKitFingerprint" title="Permalink to this definition">¶</a></dt>
<dd><p>This is an interface to the molecular fingerprints available in RDKit package.</p>
<dl class="docutils">
<dt>fingerprint_type <span class="classifier-delimiter">:</span> <span class="classifier">str, optional (default=’Morgan’)</span></dt>
<dd><dl class="first last docutils">
<dt>The type of fingerprint. Available fingerprint types:</dt>
<dd><ul class="first last simple">
<li>‘hashed_atom_pair’ or ‘hap’</li>
<li>‘MACCS’</li>
<li>‘Morgan’</li>
<li>‘hashed_topological_torsion’ or ‘htt’</li>
<li>‘topological_torsion’ or ‘tt’</li>
</ul>
</dd>
</dl>
</dd>
<dt>vector: str, optional (default = ‘bit’)</dt>
<dd><dl class="first last docutils">
<dt>Available options for vector:</dt>
<dd><ul class="first last simple">
<li><dl class="first docutils">
<dt>‘int’ <span class="classifier-delimiter">:</span> <span class="classifier">represent counts for each fragment instead of bits</span></dt>
<dd>It is not available for ‘MACCS’.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>‘bit’ <span class="classifier-delimiter">:</span> <span class="classifier">only zeros and ones</span></dt>
<dd>It is not available for ‘Topological_torsion’.</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</dd>
<dt>n_bits: int, optional (default = 1024)</dt>
<dd><p class="first">It sets number of elements/bits in the ‘bit’ type of fingerprint vectors.
Not availble for:</p>
<blockquote class="last">
<div><ul class="simple">
<li>‘MACCS’ - (MACCS keys have a fixed length of 167 bits)</li>
<li>‘Topological_torsion’ - doesn’t return a bit vector at all.</li>
</ul>
</div></blockquote>
</dd>
<dt>radius: int, optional (default = 2)</dt>
<dd>only availble for ‘Morgan’ fingerprint.</dd>
<dt>remove_hydrogen: bool, optional (default=True)</dt>
<dd>If True, remove any hydrogen from the graph of a molecule.</dd>
</dl>
<p>data set of fingerprint vectors.</p>
<dl class="method">
<dt id="chemml.chem.RDKitFingerprint.read_">
<code class="descname">read_</code><span class="sig-paren">(</span><em>molfile</em>, <em>path=None</em>, <em>*arguments</em><span class="sig-paren">)</span><a class="headerlink" href="#chemml.chem.RDKitFingerprint.read_" title="Permalink to this definition">¶</a></dt>
<dd><p>(MolfromFile)
Construct molecules from one or more input files.</p>
<dl class="docutils">
<dt>molfile: string</dt>
<dd><p class="first">This is the place you define molecules file name and path. It can contain
any special character in the following list:</p>
<blockquote>
<div><ul class="simple">
<li>: matches everything</li>
</ul>
<p>?       : matches any single character
[seq]   : matches any character in seq
[!seq]  : matches any character not in seq
/       : filename seperator</p>
</div></blockquote>
<p>The pattern matching is implemented by fnmatch - Unix filename pattern matching.
Note: The pattern must include the extension at the end. A list of available
file extensions is provided here:</p>
<blockquote class="last">
<div>‘.mol’,’.mol2’  : molecule files
‘.pdb’          : protein data bank file
‘.tpl’          : TPL file
‘.smi’          : file of one or more lines of Smiles string
‘.smarts’       : file of one or more lines of Smarts string</div></blockquote>
</dd>
<dt>path: string, optional (default = None)</dt>
<dd>If path is None, this function tries to open the file as a single
file (without any pattern matching). Therefore, none of the above
special characters except ‘/’ are helpful when they are not part
of the file name or path.
If not None, it determines the path that this function walk through
and look for every file that mathes the pattern in the file. To start
walking from the current directory, the path value should be ‘.’</dd>
<dt><a href="#id1"><span class="problematic" id="id2">*</span></a>arguments: integer</dt>
<dd><p class="first">If sequences in the special characters should be a range of integers,
you can easily pass the start and the end arguments of range as extra
arguments. But, notice that:</p>
<blockquote class="last">
<div><dl class="docutils">
<dt>1- In this case remember to replace seq with %s. Then, you should</dt>
<dd>have [%s] or [!%s] in the file pattern.</dd>
<dt>2- for each %s you must pass two integers (always an even number</dt>
<dd>of extra arguments must be passed). Also, the order is important
and it should be in the same order of ‘%s’s.</dd>
</dl>
</div></blockquote>
</dd>
</dl>
<blockquote>
<div><p>(1)
file: ‘Mydir/1f/1_opt.smi’
path: None
sample files to be read: ‘Mydir/1f/1_opt.smi’</p>
<p>(2)
file: ‘[1,2,3,4]?/<a href="#id3"><span class="problematic" id="id4">*</span></a>_opt.mol’
path: ‘Mydir’
sample files to be read: ‘Mydir/1f/1_opt.mol’, ‘Mydir/2c/2_opt.mol’, …</p>
<p>(3)
file: ‘[!1,2]?/<a href="#id5"><span class="problematic" id="id6">*</span></a>_opt.pdb’
path: ‘.’
sample files to be read: ‘./3f/3_opt.pdb’, ‘Mydir/7c/7_opt.pdb’, …</p>
<p>(4)
file: ‘<a href="#id7"><span class="problematic" id="id8">*</span></a>[‘f’,’c’]/<a href="#id9"><span class="problematic" id="id10">*</span></a>_opt.tpl’
path: ‘Mydir’
sample files to be read: ‘Mydir/1f/1_opt.tpl’, ‘Mydir/2c/2_opt.tpl’, …</p>
<p>(5)
file: ‘[%s]?/[!%s]_opt.mol2’
arguments: 1,4,7,10
path: ‘Mydir/all’
sample files to be read: ‘Mydir/all/1f/1_opt.mol2’, ‘Mydir/all/2c/2_opt.mol2’, …</p>
</div></blockquote>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="chemml.chem.Dragon">
<em class="property">class </em><code class="descclassname">chemml.chem.</code><code class="descname">Dragon</code><span class="sig-paren">(</span><em>version=7, molFile='required_required', molInput='file', CheckUpdates=True, SaveLayout=True, PreserveTemporaryProjects=True, ShowWorksheet=False, Decimal_Separator='.', Missing_String='NaN', DefaultMolFormat='1', HelpBrowser='/usr/bin/xdg-open', RejectUnusualValence=False, Add2DHydrogens=False, MaxSRforAllCircuit='19', MaxSR='35', MaxSRDetour='30', MaxAtomWalkPath='2000', LogPathWalk=True, LogEdge=True, Weights=('Mass', 'VdWVolume', 'Electronegativity', 'Polarizability', 'Ionization', 'I-State'), SaveOnlyData=False, SaveLabelsOnSeparateFile=False, SaveFormatBlock='%b-%n.txt', SaveFormatSubBlock='%b-%s-%n-%m.txt', SaveExcludeMisVal=False, SaveExcludeAllMisVal=False, SaveExcludeConst=False, SaveExcludeNearConst=False, SaveExcludeStdDev=False, SaveStdDevThreshold='0.0001', SaveExcludeCorrelated=False, SaveCorrThreshold='0.95', SaveExclusionOptionsToVariables=False, SaveExcludeMisMolecules=False, SaveExcludeRejectedMolecules=False, blocks=[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30], molInputFormat='SMILES', SaveStdOut=False, SaveProject=False, SaveProjectFile='Dragon_project.drp', SaveFile=True, SaveType='singlefile', SaveFilePath='Dragon_descriptors.txt', logMode='file', logFile='Dragon_log.txt', external=False, fileName=None, delimiter=',', consecutiveDelimiter=False, MissingValue='NaN', RejectDisconnectedStrucuture=False, RetainBiggestFragment=False, DisconnectedCalculationOption='0', RoundCoordinates=True, RoundWeights=True, RoundDescriptorValues=True, knimemode=False</em><span class="sig-paren">)</span><a class="headerlink" href="#chemml.chem.Dragon" title="Permalink to this definition">¶</a></dt>
<dd><p>An interface to Dragon 6 and 7 chemoinformatics software. Dragon is a commercial software and
you should provide</p>
<dl class="docutils">
<dt>version: int, optional (default=7)</dt>
<dd>The version of available Dragon on the user’s system. (available versions: 6 or 7)</dd>
<dt>Weights: list, optional (default=[“Mass”,”VdWVolume”,”Electronegativity”,”Polarizability”,”Ionization”,”I-State”])</dt>
<dd>A list of weights to be used</dd>
<dt>blocks: list, optional (default = list(range(1,31)))</dt>
<dd>A list of integers as descriptor blocks’ id. There are totally 29 and 30 blocks available in
version 6 and 7, respectively.
This module is not atimed to cherry pick descriptors in each block.
For doing so, please use Script Wizard in Drgon GUI.</dd>
<dt>external: boolean, optional (default=False)</dt>
<dd>If True, include external variables at the end of each saved file.</dd>
</dl>
<blockquote>
<div><dl class="docutils">
<dt>The documentation for the rest of parameters can be found in the following links:</dt>
<dd><ul class="first last simple">
<li><a class="reference external" href="http://www.talete.mi.it/help/dragon_help/index.html">http://www.talete.mi.it/help/dragon_help/index.html</a></li>
<li><a class="reference external" href="https://chm.kode-solutions.net/products_dragon_tutorial.php">https://chm.kode-solutions.net/products_dragon_tutorial.php</a></li>
</ul>
</dd>
</dl>
<p>In the current version, we recommend the user to use this class with the following parameters:
molInput = ‘file’
molfile = path to one SMILES representation file with .smi format or a dictionary of many filepaths
script = ‘new’</p>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chemml.chem</span> <span class="k">import</span> <span class="n">Dragon</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">drg</span> <span class="o">=</span> <span class="n">Dragon</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">drg</span><span class="o">.</span><span class="n">script_wizard</span><span class="p">(</span><span class="n">script</span><span class="o">=</span><span class="s1">&#39;new&#39;</span><span class="p">,</span> <span class="n">output_directory</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">drg</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_path</span> <span class="o">=</span> <span class="n">drg</span><span class="o">.</span><span class="n">data_path</span>  <span class="c1"># path to the output file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">df_path</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;No.&#39;</span><span class="p">,</span><span class="s1">&#39;NAME&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="chemml.chem.Dragon.script_wizard">
<code class="descname">script_wizard</code><span class="sig-paren">(</span><em>script='new'</em>, <em>output_directory='./'</em><span class="sig-paren">)</span><a class="headerlink" href="#chemml.chem.Dragon.script_wizard" title="Permalink to this definition">¶</a></dt>
<dd><p>The script_wizard is designed to build a Dragon script file. The name and
the functionality of this function is the same as available Script wizard
in the Dragon Graphic User Interface.
Note: All reported nodes are mandatory, except the &lt;EXTERNAL&gt; tag
Note: Script for version 7 doesn’t support fingerprints block</p>
<dl class="docutils">
<dt>script: string, optional (default=”new”)</dt>
<dd>If “new” start creating a new script from scratch. If you want to load an existing script,
pass the filename with drs format.</dd>
<dt>output_directory: string, optional (default = ‘./’)</dt>
<dd>the path to the working directory to store output files.</dd>
<dt>dragon: xml element</dt>
<dd>Dragon script in  xml format.</dd>
<dt>drs: string</dt>
<dd>Dragon script file name</dd>
<dt>data_path: string</dt>
<dd>The path+name of saved data file in any format. If saveType is ‘block’
or ‘subblock’ data_path is just the path to the directory that all data
files have been saved.</dd>
</dl>
<blockquote>
<div>class parameters</div></blockquote>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="chemml.chem.magpie_python.html" class="btn btn-neutral float-right" title="Magpie_Python module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="ga_feature_selection.html" class="btn btn-neutral" title="Feature Selection" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014-2018 Johannes Hachmann, Mojtaba Haghighatlari.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.5.1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/language_data.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
      <script type="text/javascript" src="None"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>